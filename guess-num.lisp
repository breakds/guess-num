;;;; guess-num.lisp

(defpackage #:breakds.guess-num
  (:nicknames #:guess-num)
  (:use #:cl
        #:parenscript
        #:realispic))

(in-package #:breakds.guess-num)

(eval-when (:compile-toplevel :load-toplevel :execute)
  (enable-jsx-reader))

(defun random-4-digit ()
  (let ((sorted (sort (loop for i below 10
			 collect (list (random 1.0) i))
		      #'<
		      :key #'car)))
    (loop 
       for x in sorted
       for i below 4
       collect (cadr x))))

(def-rpc initialize ()
  (setf (hunchentoot:session-value 'key) (random-4-digit))
  (setf (hunchentoot:session-value 'records) nil)
  (format nil "狺ㄨ躅汨孱麸雉后弩箝镱鲠祯щ妁┅ㄤ彐蝠汜煦蹯狒瀛栝铘铛愆戾舄è狒翦眇祜镳骘忮祜泔祆邈疳蝮瀛轭翦珏铛后翎螋哄钿ū椹┅ㄡ祜镳骘忮祜篚ㄩㄥ祠狒翦眇椹ㄥ祠ㄨ躅汨孱麸雉后弩箝镱鲠祯щ妁椹癌┅ㄢō祜镳骘轭狒翦眇篚ㄩ礤礅弪ㄨ躅汨孱麸雉后弩箝镱鲠祯щ妁┅癌岍┅瘐箬扉篝猴怅ㄣ镱㈩蹴忮颌铛愆ㄣ镱㈣轭簪ㄦ矧磲铋崃崧猢┅ㄨ躅汨孱麸雉后弩箝镱鲠祯蝈泔蜾螬蝈鲥蝮ㄨ躅汨孱麸雉后弩箝镱鲠祯蝈泔蜾螬┅ㄤ彐鏖溏弭玑礤怙è蝈泔蜾ㄡ蝌狴┅è栳钿戾篚忭轸ㄤ狒岍鏖翳蝠ㄣ犰沲灬翦栝铘溽翎翦舂ㄣ栳轭翳轶箦舡篝狒ㄣ蝈狒蝈泔蜾蝠悱蝈篚祠┅ㄣ栳轭泔铙镬祜蝠悱蝈篚祠┅驷祗濠ｊ篪ê溟īê璞è沆狍蟓钺礤Ⅳ轸戾┅⑶蹂篌熙礅弪ê溟è沆狍蟓钺礤Ⅳ镳泔狒扉篝哌泔铘衢铄颌┅ê蹯è沆狍蟓钺礤Ⅳ镳泔狒扉篝┅ê璩è沆狍蟓钺礤Ⅳ镳泔狒扉篝哌桢徜弪┅⒁弩蹯艉è翳轶篝狒蝈泔蜾磲皓灬礅溽蝈泔蜾ê玑礤蝈泔蜾è铛礅弪蝈泔蜾铛礅弪┅ㄨ轭蝈泔蜾栝铘┅┅┅┅ê轭翦蜥泗轱瞽狎遽è镱篚忭轸翳轶栳钿戾篚忭轸┅┅┅ㄤ彐鏖溏弭轭翦蜥泗轱瞽狎遽īè栳钿戾篚忭轸īㄣ栳轭翳轶痱镳镱篚忭轸ㄣ蝈狒翦ㄣ栳轭祜汜飙铒溴翦舡铛愆鲠祯趄轫┅┅箦翩祜汜飙铒溴翦舡铛愆鲠祯濠驷祗濠ｊ篪ê骘蝽è镱篚忭轸翳轶栳钿戾篚忭轸┅ê轭瘐è蝈Ⅳ屮舡铛恝豉疱Ⅲ遽蜚琚痨徙彖镬溴瀹绠辈炒ㄣ灬篌钺礤Ⅳ镳泔狒箦狎汨轭瘐簪┅ê怩趑镱è沆狍蟓钺礤Ⅳ镳泔狒怩趑镱豉疱Ⅲ踱黹簪┅⒂踱黹簪┅ㄤ彐鏖溏弭玑礤蝈泔蜾īīｊ篪ê扉è沆狍蟓钺礤Ⅳ镳泔狒扉篝哌轸屙┅ǐ翳轶痱镳铛礅弪翳轶痱镳栝铘┅┅ㄤ彐蝈犰轶痖悱狃ㄧ蹂篌铛憝狃呼轸戾⑶蹂篌熙礅弪红殁á梏麴函驸礤蝈徙舡爱卑爱黹町牦㈣趑鸷彡狲顼镧戾狃轶泔懑彡狲扉怏犟蹂蝙伯碑悲犟蹂蝙黹町牦恒篌á梏麴函沅铌螽沆秕滏灬蝈泔懑彡狲扉怏麸疸镝舣爱府隘泱蟑麸疸镝舡溴箅麸瓠扉玷舢黹町泱螈轰镢蹴孱舡忉箦ㄡ箐婧簌篝屙箫躜沐溟蝈泗矧х蹂篌铛愆吼矧贝掣订戾è轭瘐舡溽翎ㄡ蝌狴ㄣ蝈狒铛礅弪⒈渤储栝铘⒈帘垄ㄣ蝈狒铛礅弪⒉炒耽栝铘⒊涟垄┅┅鏖翳蝠ㄩ铋糸犰辁濠ㄣ栳轭泔铙镬祜蝠悱蝈篚祠┅ｊ篪ê玑礤怙è溽翎轭瘐舡溽翎┅┅ㄥ鲠飙麒孱ê泔眇殪瀛麸痨弼屐红镝洵麸痨弼屐哄邈豸濠ㄤ轶徕戾牦蝈徜弪┅