;;;; guess-num.lisp

(defpackage #:breakds.guess-num
  (:nicknames #:guess-num)
  (:use #:cl
        #:parenscript
        #:realispic))

(in-package #:breakds.guess-num)

(eval-when (:compile-toplevel :load-toplevel :execute)
  (enable-jsx-reader))

(defun random-4-digit ()
  (let ((sorted (sort (loop for i below 10
			 collect (list (random 1.0) i))
		      #'<
		      :key #'car)))
    (loop 
       for x in sorted
       for i below 4
       collect (cadr x))))

(def-rpc initialize ()
  (setf (hunchentoot:session-value 'key) (random-4-digit))
  (setf (hunchentoot:session-value 'records) nil)
  (format nil "狺ㄨ躅汨孱麸雉后弩箝镱鲠祯щ妁┅ㄤ彐蝠汜煦蹯狒瀛栝铘铛愆戾舄è狒翦眇祜镳骘忮祜泔祆邈疳蝮瀛轭翦珏铛后翎螋哄钿ū椹┅ㄡ祜镳骘忮祜篚ㄩㄥ祠狒翦眇椹ㄥ祠ㄨ躅汨孱麸雉后弩箝镱鲠祯щ妁椹癌┅ㄢō祜镳骘轭狒翦眇篚ㄩ礤礅弪ㄨ躅汨孱麸雉后弩箝镱鲠祯щ妁┅癌岍┅瘐箬扉篝猴怅ㄣ镱㈩蹴忮颌铛愆ㄣ镱㈣轭簪ㄦ矧磲铋崃崧猢┅ㄨ躅汨孱麸雉后弩箝镱鲠祯蝈泔蜾螬啜猴怅ㄣ镱Ⅱ邈矧潴蝈鲥蝮ㄨ躅汨孱麸雉后弩箝镱鲠祯蝈泔蜾螬┅ㄣ镱㈢蹂篌邃ㄩ穿烘┅┅ㄤ彐鏖溏弭玑礤怙īè篝狒蝈泔蜾ㄡ蝌狴┅ㄧ犴瀛秭弪铋飑ㄨ犷潇瀛篚忭轸ㄤ狒岍鏖翳蝠ㄣ犰沲灬翦栝铘溽翎翦舂ㄣ栳轭翳轶箦舡篝狒ㄣ蝈狒蝈泔蜾蝠悱蝈篚祠蝈泔蜾螬玑礤秭弪蝠悱蝈篚祠珲弩箦洎┅ㄣ栳轭泔铙镬祜蝠悱蝈篚祠┅驷祗濠ｊ篪ê溟īê璞è沆狍蟓钺礤Ⅳ轸戾┅⑶蹂篌熙礅弪ê溟è沆狍蟓钺礤Ⅳ镳泔狒扉篝哌泔铘衢铄颌┅ê蹯è沆狍蟓钺礤Ⅳ镳泔狒扉篝┅ê璩è沆狍蟓钺礤Ⅳ镳泔狒扉篝哌桢徜弪┅⑶犴义泔蜾螈ㄣ栳轭祜汜飙篝狒蝈泔蜾螬磲灬礅溽蝈泔蜾ê玑礤蝈泔蜾è铛礅弪蝈泔蜾铛礅弪┅ㄨ轭蝈泔蜾栝铘┅┅┅┅ㄩ祜汜飙篝狒玑礤秭弪ê蝈箦舡疳铄飑ê轭翦蜥泗轱瞽狎遽è痱镢弩蟓珲弩翳轶栳钿戾篚忭轸┅┅┅ㄤ彐鏖溏弭轭翦蜥泗轱瞽狎遽痱镢弩蟓珲弩螬è栳钿戾篚忭轸ī痱镢弩蟓珲弩ㄣ蝈狒翦ㄣ栳轭祜汜飙铒溴翦舡铛愆鲠祯趄轫┅┅箦翩祜汜飙铒溴翦舡铛愆鲠祯濠驷祗濠ｊ篪ê骘蝽è镱篚忭轸翳轶栳钿戾篚忭轸┅ê轭瘐è蝈Ⅳ屮舡铛恝豉疱Ⅲ遽蜚琚痨徙彖镬溴瀹绠辈炒ㄣ灬篌钺礤Ⅳ镳泔狒箦狎汨轭瘐簪┅ê怩趑镱è沆狍蟓钺礤Ⅳ镳泔狒怩趑镱泗幄豉疱Ⅲ踱黹簪┅⑶蹂篌┅ㄤ彐鏖溏弭蝈箦舡疳铄īè栳钿戾篚忭轸īㄣ栳轭鏖钿秣祜汜糸镱蝈祜徜舂┅ｊ篪ê骘蝽è镱篚忭轸翳轶栳钿戾篚忭轸┅ê怩趑镱è沆狍蟓钺礤Ⅳ镳泔狒怩趑镱泗幄篝戾ㄣ蝈狒⑩徙腌蝻躅洵泔祜颌㈧殓梏珧邋睥┅①秕鏖町义篝狎舢┅ㄤ彐鏖溏弭玑礤蝈泔蜾铛礅弪栝铘īｊ篪ê扉è沆狍蟓钺礤Ⅳ镳泔狒扉篝哌轸屙┅ê箴犷è篝戾ㄣ蝈狒㈡镱舡箝澧⒉梆┅ǐ铛礅弪┅ê箴犷è沆狍蟓钺礤Ⅳ镳泔狒铒糸骈汜糸镱┅栝铘┅ㄤ彐蝈犰轶痖悱狃ㄧ蹂篌铛憝狃呼轸戾⑶蹂篌熙礅弪红殁á梏麴函驸礤蝈徙舡爱卑爱牦㈣趑鸷彡狲顼镧戾狃轶泔懑彡狲扉怏犟蹂蝙伯碑悲犟蹂蝙黹町牦恒篌á梏麴函沅铌螽沆秕滏灬蝈泔懑彡狲扉怏麸疸镝舣爱府隘泱蟑麸疸镝舡盹忾戾扉玷舢黹町泱螈轰镢蹴孱舡忉箦ㄡ箐婧簌篝屙箫躜沐溟蝈泗矧х蹂篌铛愆吼矧贝掣订鏖翳蝠ㄩ铋糸犰辁濠ㄣ栳轭泔铙镬祜蝠悱蝈篚祠┅ｊ篪ê玑礤怙┅ㄥ鲠飙麒孱ê泔眇殪瀛麸痨弼屐红镝洵麸痨弼屐哄邈豸濠ㄤ轶徕戾牦蝈徜弪┅